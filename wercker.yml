box: ruby
build:
    steps:
      # Run a smart version of bundle install
      # which improves build execution time
      # future builds
      - bundle-install

      - script:
        name: generate site
        code: bundle exec jekyll build --trace

deploy:
  steps:
    - edgecaseadmin/install-aws-cli:
        key: $AWS_CLI_KEY
        secret: $AWS_CLI_SECRET

    - script:
        name: aws html
        code: |
          aws s3 sync _site/ $URL --acl public-read --cache-control "public, max-age=31536000" --delete --exclude "*.html"
    - script:
        name: aws all else
        code: |
          aws s3 sync _site/ $URL --acl public-read --cache-control "public, max-age=3600" --delete --exclude "*" --include "*.html"
